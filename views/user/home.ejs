<%- include("../../views/partials/user/header") %>

<style>
    .shop-button {
    background-color: black;
    color: white;
    font-weight: bold;
    font-size: 14px;
    padding: 8px 18px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    opacity: 0;
    transform: scale(0.8);
    transition: opacity 0.3s ease-out, transform 0.3s ease-out, box-shadow 0.3s ease-out;
}

/* Show button on hover */
.single_catagory_area:hover .shop-button {
    color: white;
    opacity: 1;
    transform: scale(1);
    background-color: rgb(35, 35, 35);

}

.shop-button:hover {
    color: white;
    transform: scale(1.1);
    background-color: rgb(35, 35, 35);

}

</style>

    <!-- ##### Welcome Area Start ##### -->
    <section class="welcome_area bg-img background-overlay" style="background-image: url(img/bg-img/home-2.jpg);">
        <div class="container h-100">
            <div class="row h-100 align-items-center">
                <div class="col-12">
                    <div class="hero-content">
                        <h6>Filmatic</h6>
                        <h2>New Collection</h2>
                        <a href="/shop" class="btn essence-btn">view collection</a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- ##### Welcome Area End ##### -->

    <!-- ##### Top Catagory Area Start ##### -->
    <div class="top_catagory_area section-padding-80 clearfix">
        <div class="container">
            <div class="row justify-content-center">
                <!-- Single Catagory -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="single_catagory_area d-flex flex-column flex-md-row align-items-center justify-content-between p-4"
                        style="border-radius: 20px; background-color: rgb(246, 246, 246); position: relative; overflow: hidden;">
                    
                        <!-- Left Side: Text Content -->
                        <div class="catagory-content text-center text-md-left" style="flex: 1; position: relative;">
                            <h2 style="font-size: 24px; margin-bottom: 10px;">Clothing</h2>
                            <ul style="list-style: none; font-weight: normal; padding: 0; margin-bottom: 15px; font-size: 12px; line-height: 1.6;">
                                <li>Explore your favourite movie T-shirts</li>
                            </ul>
                            <a href="/shop" class="shop-button">
                                Shop now
                            </a>
                        </div>
                
                        <!-- Right Side: Image -->
                        <div class="image-container mt-3 mt-md-0 text-center" style="flex: 1;">
                            <img src="img/bg-img/Breakingbad1.png" alt="For men" 
                                style="width: 100%; max-width: 150px; object-fit: contain; margin-top: 40px;">
                        </div>
                
                    </div>
                </div>
                
                                
                
                <!-- Single Catagory -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="single_catagory_area d-flex flex-column flex-md-row align-items-center justify-content-between p-4"
                        style="border-radius: 20px; background-color: rgb(246, 246, 246); position: relative; overflow: hidden;">
                    
                        <!-- Left Side: Text Content -->
                        <div class="catagory-content text-center text-md-left" style="flex: 1; position: relative;">
                            <h2 style="font-size: 24px; margin-bottom: 10px;">Posters</h2>
                            <ul style="list-style: none; font-weight: normal; padding: 0; margin-bottom: 15px; font-size: 12px; line-height: 1.6;">
                                <li>Transform Your Space with Cinematic Art!</li>
                            </ul>
                            <a href="/shop" class="shop-button">
                                Shop now
                            </a>
                        </div>
                
                        <!-- Right Side: Image -->
                        <div class="image-container mt-3 mt-md-0 text-center" style="flex: 1;">
                            <img src="img/bg-img/123.jpg" alt="For men" 
                                style="width: 100%; max-width: 150px; transform: scale(0.9);object-fit: contain;">
                        </div>
                
                    </div>
                </div>

                <!-- Single Catagory -->
                <div class="col-12 col-sm-6 col-md-4">
                    <div class="single_catagory_area d-flex flex-column flex-md-row align-items-center justify-content-between p-4"
                        style="border-radius: 20px; background-color: rgb(246, 246, 246); position: relative; overflow: hidden;">
                    
                        <!-- Left Side: Text Content -->
                        <div class="catagory-content text-center text-md-left" style="flex: 1; position: relative;">
                            <h2 style="font-size: 24px; margin-bottom: 10px;">Accessories</h2>
                            <ul style="list-style: none; font-weight: normal; padding: 0; margin-bottom: 15px; font-size: 12px; line-height: 1.6;">
                                <li>Iconic Films, Everyday Essentials!</li>
                            </ul>
                            <a href="/shop"  class="shop-button">
                                Shop now
                            </a>
                        </div>
                
                        <!-- Right Side: Image -->
                        <div class="image-container mt-3 mt-md-0 text-center" style="flex: 1;">
                            <img src="img/bg-img/cap1.png" alt="For men" 
                                style="width: 100%; max-width: 150px; object-fit: contain;">
                        </div>
                
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ##### Top Catagory Area End ##### -->

    <!-- ##### CTA Area Start ##### -->
    <div class="cta-area">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="cta-content d-flex" style="background-color:rgb(246, 246, 246) ;">
                        <!-- Left Div: Image -->
                        <div class="cta-image" style="flex: 1; transform: scale(1); background-image: url(img/bg-img/godfather.png); background-size: cover; background-position: center;"></div>
                        <!-- Right Div: Product Details -->
                        <div class="cta-text d-flex align-items-center justify-content-center" style="flex: 1;  color: white; padding: 20px;">
                            <div style="width: 80%; display: flex; flex-direction: column; align-items: center;">
                                <!-- Upper Section: Product Image -->
                                <div style="width: 100%; height: 150px; background-image: url(img/bg-img/product.png); background-size: contain; background-repeat: no-repeat; background-position: center;"></div>
                                <!-- Lower Section: Shop Button -->
                                <div style="margin-top: 10px;">
                                    <h6>-60%</h6>
                                    <h2>Global Sale</h2>
                                    <a href="/shop" class="btn essence-btn">Buy Now</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ##### CTA Area End ##### -->

   <!-- ##### New Arrivals Area Start ##### -->

                <section class="new_arrivals_area section-padding-80 clearfix">
                    <div class="container">
                        <div class="row">
                            <div class="col-12">
                                <div class="section-heading text-center">
                                    <h2>New Arrivals</h2>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="container">
                        <div class="row">
                        <% for(let i=0;i<products.length;i++) { %>  
                    
                            <!-- Single Product -->
                            <div class="col-md-3 col-sm-6">
                                <div class="single-product-wrapper">
                                    <a href="/productDetails?id=<%= products[i]._id %>">
                                        <div class="product-img">
                                            <img src="uploads/resized-images/<%= products[i].productImage[0] %>" alt="<%=products[i].productName %>">
                                            <% if(products[i].productImage[1]) { %>
                                                <img class="hover-img" src="uploads/resized-images/<%= products[i].productImage[1] %>" alt="">
                                            <% } %>

                                            <% if (products[i].bestOffer > 0) { %>
                                                <div class="product-badge offer-badge">
                                                    <span>-<%= products[i].bestOffer %>% OFF</span>
                                                </div>
                                            <% } %>

                                            <div class="product-favourite">
                                                <a onclick="addToWishlist('<%= products[i]._id  %>')" class="favme fa fa-heart"></a>
                                            </div>
                                        </div>
                                        <div class="product-description">
                                            <h6><%= products[i].productName %></h6>
                                            <p class="product-price">
                                                <% if (products[i].bestOffer > 0) { %>
                                                    <span class="old-price">₹<%= products[i].regularPrice %></span>
                                                <% } %>
                                                ₹<%= products[i].finalPrice %>
                                            </p> 
                                        </div>
                                    </a>
                                    <div class="add-to-cart-btn">
                                        <button onclick="addToCart('<%= products[i]._id %>')" class="btn essence-btn">Add to Cart</button>
                                    </div>
                                </div>
                            </div>
                        
                        <% } %>
                    </div>
                    </div>
                </section>

    <!-- ##### New Arrivals Area End ##### -->

    <script>
        
        async function addToCart(productId) {

            try {
                
            const response=await fetch('/addToCart',{
                method:'POST',
                headers: {'Content-Type': 'application/json'},
                body:JSON.stringify({productId:productId,quantity:1})
            })

            const data=await response.json()

            if (!data.success && data.redirectUrl) {
            window.location.href = data.redirectUrl; 
            return;
            }
            
            if(data.success){
                Toastify({
                text: "Added to Cart",
                duration: 2000,
                gravity: "top",
                position: "right", 
                backgroundColor: "green",
                stopOnFocus: true
            }).showToast();
            }
            else{
                Toastify({
                text: data.message,
                duration: 2000,
                gravity: "top",
                position: "right",
                backgroundColor: "red",
                stopOnFocus: true
            }).showToast();
            }

            } catch (error) {
             console.error('Error:', error);
             Toastify({
                text: "Something went wrong. Please try again.",
                duration: 2000,
                gravity: "top",
                position: "right",
                backgroundColor: "red",
                stopOnFocus: true
             }).showToast();
            }
        }


        async function addToWishlist(productId) {

            try {
                const response=await fetch('/addToWishlist',{
                method:'POST',
                headers: {'Content-Type': 'application/json'},
                body:JSON.stringify({productId:productId})
                })

                 const data=await response.json()

                 if (!data.success && data.redirectUrl) {
                    window.location.href = data.redirectUrl;
                    return;
                }


                if(data.success){
                    Toastify({
                    text: "Added Wishlist",
                    duration: 2000,
                    gravity: "top",
                    position: "right",
                    backgroundColor: "green",
                    stopOnFocus: true
                }).showToast();
                }
                else{
                    Toastify({
                    text: data.message,
                    duration: 2000,
                    gravity: "top",
                    position: "right",
                    backgroundColor: "red",
                    stopOnFocus: true
                }).showToast();
                }
            }


            catch (error) {
                console.error('Error:', error);
                    Toastify({
                        text: "Something went wrong. Please try again.",
                        duration: 2000,
                        gravity: "top",
                        position: "right",
                        backgroundColor: "red",
                        stopOnFocus: true
                    }).showToast();      
             }


        }


        



    </script>


    <%- include("../../views/partials/user/footer") %>